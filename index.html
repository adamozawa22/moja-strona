<script>
async function loadEntries() {
  const res = await fetch('/.netlify/functions/guestbook');
  const data = await res.json();
  const guestbook = document.getElementById('guestbook');
  guestbook.innerHTML = '';
  data.reverse().forEach(e => {
    const div = document.createElement('div');
    div.classList.add('message');
    div.innerHTML = `<strong>${e.name}</strong>: ${e.message}`;
    guestbook.appendChild(div);
  });
}

async function saveEntry(event) {
  event.preventDefault();
  const name = document.querySelector('[name="name"]').value;
  const message = document.querySelector('[name="message"]').value;

  await fetch('/.netlify/functions/guestbook', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name, message })
  });

  document.querySelector('form').reset();
  loadEntries();
}

document.querySelector('form').addEventListener('submit', saveEntry);
loadEntries();
</script>



















