<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Retro Tester</title>
   <link rel="stylesheet" href="style.css">
</head>
<body background="bg.gif">
</head>
<body>
<center>
  <h1><img src="logo.gif" alt="LOGO"></h1>
  <a href="index.html">â¬… PowrÃ³t</a>
  <hr>

  <table>
    <tr><td align="center">
      <h2>ğŸ¥ Kamera </h2>
      <button id="startCam">WÅ‚Ä…cz kamerÄ™ </button>
      <button id="stopCam">WyÅ‚Ä…cz</button><br>
      <video id="camPreview" width="360" height="240" autoplay muted playsinline></video>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸ™ï¸ Nagrywanie Audio</h2>
      <button id="startRec">Start nagrywania</button>
      <button id="stopRec">Stop nagrywania</button><br>
      <audio id="audioPlayback" controls></audio>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸ“¸ ZdjÄ™cie z Odliczaniem</h2>
      <button id="takeShot">ZrÃ³b zdjÄ™cie</button>
      <div id="countdown">3</div>
      <video id="shotPreview" width="360" height="240" autoplay muted playsinline></video>
      <canvas id="photoCanvas" width="360" height="240"></canvas>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸ¬ Test Wideo</h2>
      <video id="localVideo" controls width="480">
        <source src="sample.mp4" type="video/mp4">
        Twoja przeglÄ…darka nie wspiera wideo.
      </video>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸµ Test Audio</h2>
      <audio id="localAudio" controls>
        <source src="sample.mp3" type="audio/mp3">
        Twoja przeglÄ…darka nie wspiera audio.
      </audio>
    </td></tr>

    <tr><td align="center">
      <h2>â–¶ï¸ YouTube Player</h2>
      <iframe width="480" height="270" src="https://www.youtube.com/embed/dQw4w9WgXcQ"
              frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸŒ Internet & Ping</h2>
      <button id="pingTest">Test Pingu</button>
      <div id="netStatus">Kliknij "Test Pingu".</div>
    </td></tr>

    <tr><td align="center">
      <h2>ğŸ“œ Log</h2>
      <div id="results">Log startuje...</div>
    </td></tr>
  </table>

  <hr>
  <img src="linuxnow.jpg" alt="Linux Now!" width="88" height="31"><br>
  <p><small>2025-2025 Moja Strona Retro</small></p>
</center>

<script>
const logBox=document.getElementById('results');
function log(m){logBox.textContent+="\\n"+m;}

// ğŸ¥ Kamera + mic
let camStream=null;
startCam.onclick=async()=>{
  try{
    camStream=await navigator.mediaDevices.getUserMedia({video:true,audio:true});
    camPreview.srcObject=camStream;
    log("Kamera + mic OK");
  }catch(e){log("BÅ‚Ä…d: "+e);}
};
stopCam.onclick=()=>{
  if(camStream){camStream.getTracks().forEach(t=>t.stop());camPreview.srcObject=null;log("WyÅ‚Ä…czono kamerÄ™");}
};

// ğŸ™ï¸ Nagrywanie audio
let mediaRecorder, audioChunks=[];
startRec.onclick=async()=>{
  try{
    const stream=await navigator.mediaDevices.getUserMedia({audio:true});
    mediaRecorder=new MediaRecorder(stream);
    audioChunks=[];
    mediaRecorder.ondataavailable=e=>audioChunks.push(e.data);
    mediaRecorder.onstop=()=>{
      const blob=new Blob(audioChunks,{type:'audio/webm'});
      audioPlayback.src=URL.createObjectURL(blob);
      log("Nagranie gotowe");
    };
    mediaRecorder.start();
    log("Nagrywanie...");
  }catch(e){log("Mic error: "+e);}
};
stopRec.onclick=()=>{
  if(mediaRecorder&&mediaRecorder.state==="recording"){mediaRecorder.stop();log("Stop nagrywania");}
};

// ğŸ“¸ Auto-zdjÄ™cie z odliczaniem
const countdown=document.getElementById('countdown');
const shotPreview=document.getElementById('shotPreview');
let shotStream=null;
takeShot.onclick=async()=>{
  try{
    shotStream=await navigator.mediaDevices.getUserMedia({video:true});
    shotPreview.srcObject=shotStream;
    countdown.style.display="block";
    let time=3;
    countdown.textContent=time;
    const timer=setInterval(()=>{
      time--;
      if(time>0){countdown.textContent=time;}
      else{
        clearInterval(timer);
        countdown.style.display="none";
        capturePhoto();
      }
    },1000);
  }catch(e){log("BÅ‚Ä…d kamery: "+e);}
};

function capturePhoto(){
  const canvas=document.getElementById('photoCanvas');
  const ctx=canvas.getContext('2d');
  ctx.drawImage(shotPreview,0,0,canvas.width,canvas.height);
  log("ğŸ“¸ ZdjÄ™cie zrobione!");
  if(shotStream){
    shotStream.getTracks().forEach(t=>t.stop());
    shotPreview.srcObject=null;
    log("Kamera wyÅ‚Ä…czona po zdjÄ™ciu");
  }
}

// ğŸŒ Ping test
pingTest.onclick=async()=>{
  const start=performance.now();
  try{
    await fetch("https://www.google.com",{mode:"no-cors"});
    const ms=Math.round(performance.now()-start);
    netStatus.textContent="âœ… Internet OK, ping: "+ms+"ms";
    log("Ping "+ms+"ms");
  }catch(e){netStatus.textContent="âŒ Brak neta";log("Ping fail: "+e);}
};
</script>
</body>
</html>
